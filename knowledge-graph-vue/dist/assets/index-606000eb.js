import{_ as X}from"./index.vue_vue_type_script_setup_true_lang-c8f76168.js";import{_ as Z}from"./dataSourceModel.vue_vue_type_script_setup_true_lang-e2007d9d.js";import{_ as Y}from"./CommonPage-69c64d74.js";import{d as ee,m as s,aq as $,ak as ae,H as te,Z as c,O as v,P as y,Q as l,R as t,S as b,aA as ne,W as m,aB as le,aC as oe,au as se,U as ce,$ as h,X as de,a0 as ue,F as ie,av as z,h as D,aw as P,ax as pe,as as C,ai as re,aj as B,az as _e,_ as ve}from"./index-4af02034.js";import"./ArrowUpOutlined-15a0d937.js";import"./UnorderedListOutlined-1cb56e24.js";import"./ChromeFilled-5bd66bf5.js";import"./EditFilled-d0e6b41f.js";import"./QuestionOutlined-b1288c8f.js";import"./index.vue_vue_type_script_setup_true_lang-24ddc9a9.js";import"./AppPage-24725091.js";const me={class:"content-table"},fe=ee({__name:"index",setup(ye){s();const k=$({}),r=s(!1),g=s([]),n=s({}),U=s([{label:"结构化数据",value:"结构化数据"},{label:"半结构数据",value:"半结构数据"},{label:"非结构化数据",value:"非结构化数据"}]),E=s([{label:"可用",value:1},{label:"不可用",value:2}]),w=s([]),N=s(0),i=s(!1),d=$({current:1,page_size:10,pageSizeOptions:["10","20","30","40"],page:1,total:0,showSizeChanger:!0,showQuickJumper:!1,showTotal:e=>`总记录 ${e} `,onChange(e,a){d.page_size=a,d.page=e,d.current=e,u()}}),R=s([{title:"数据源名称",dataIndex:"name",key:"name"},{title:"数据类型",dataIndex:"data_type",key:"data_type"},{title:"数据库类型",dataIndex:"db_type",key:"db_type"},{title:"IP地址",dataIndex:"ip_address",key:"ip_address"},{title:"库",dataIndex:"schema_table",key:"schema_table"},{title:"表",dataIndex:"table_name",key:"table_name"},{title:"状态",dataIndex:"enabled",key:"enabled"},{title:"创建时间",dataIndex:"created_at",key:"created_at"},{title:"操作",dataIndex:"action",width:260}]);function u(){if(r.value)return;r.value=!0;const e={};e.data_type=n.value.dataType,e.status=n.value.status,e.search=n.value.search?n.value.search:null,e.page=d.page,e.page_size=d.page_size,ae("/datasource/list",e).then(a=>{w.value=a.data.data,d.total=(a==null?void 0:a.data.total)||0,N.value=(a==null?void 0:a.data.total)||0,r.value=!1})}function be(e){}function V(){k.value={},i.value=!0}function j(){i.value=!1,u()}te(()=>{u()});function q(){n.value=n.value,d.page=1,d.current=1,u()}function A(){n.value.dataType=null,n.value.status=null,n.value.search=null,u()}const F=e=>{z.confirm({title:"提示",icon:D(P),content:"要删除吗?",okText:"确定",cancelText:"取消",onOk(){pe("/datasource/id/"+(e==null?void 0:e.id)).then(a=>{C("删除成功"),u()})},onCancel(){console.log("Cancel")}})},L=e=>{console.log(e);const a={};a.db_type=e.db_type,a.ip_address=e.ip_address,a.port=e.port,a.username=e.username,a.password=e.password,a.schema_table=e.schema_table,a.table_name=e.table_name,re("/datasource/connection",a).then(_=>{_.status=="success"?C("连接成功"):B(_.message)})},M={onChange:(e,a)=>{console.log(`selectedRowKeys: ${e}`,"selectedRows: ",a),g.value=e},getCheckboxProps:e=>({disabled:e.name==="Disabled User",name:e.name})},Q=()=>{if(g.value.length==0)return B("请选择"),!1;z.confirm({title:"提示",icon:D(P),content:"要批量删除吗?",okText:"确定",cancelText:"取消",onOk(){const e={};e.ids=g.value,_e("/datasource/delete/batch",e).then(a=>{C("删除成功"),u()})},onCancel(){console.log("Cancel")}})};return(e,a)=>{const _=c("a-select"),G=c("a-input"),f=c("a-button"),I=c("a-space"),O=c("a-col"),H=c("a-row"),J=c("a-switch"),K=c("a-tag"),x=X,S=c("a-divider"),W=c("a-table");return v(),y(Y,{"show-footer":"",title:"数据源管理"},{default:l(()=>[t(H,null,{default:l(()=>[t(O,{span:20},{default:l(()=>[t(I,null,{default:l(()=>[t(_,{placeholder:"请选择数据类型",value:n.value.dataType,"onUpdate:value":a[0]||(a[0]=o=>n.value.dataType=o),style:{width:"240px"},options:U.value,allowClear:""},null,8,["value","options"]),t(_,{placeholder:"请选择链接状态",value:n.value.status,"onUpdate:value":a[1]||(a[1]=o=>n.value.status=o),style:{width:"240px"},options:E.value,allowClear:""},null,8,["value","options"]),t(G,{placeholder:"搜索关键字",style:{width:"240px"},value:n.value.search,"onUpdate:value":a[2]||(a[2]=o=>n.value.search=o)},null,8,["value"]),t(f,{type:"primary",onClick:q,loading:r.value},{icon:l(()=>[t(b(ne))]),default:l(()=>[m(" 查询 ")]),_:1},8,["loading"]),t(f,{type:"primary",onClick:A},{icon:l(()=>[t(b(le))]),default:l(()=>[m(" 重置 ")]),_:1})]),_:1})]),_:1}),t(O,{span:4,style:{"text-align":"right"}},{default:l(()=>[t(I,null,{default:l(()=>[t(f,{type:"primary",onClick:V},{icon:l(()=>[t(b(oe))]),default:l(()=>[m(" 新增 ")]),_:1}),t(f,{type:"primary",onClick:Q},{default:l(()=>[t(b(se)),m(" 批量删除 ")]),_:1})]),_:1})]),_:1})]),_:1}),ce("div",me,[t(W,{dataSource:w.value,columns:R.value,size:"middle",rowKey:"id",pagination:d,"row-selection":M,loading:r.value},{bodyCell:l(({column:o,record:p})=>[o.dataIndex==="enabled"?(v(),y(J,{key:0,checked:p.enabled==!0,onClick:T=>void 0},null,8,["checked","onClick"])):h("",!0),o.dataIndex==="db_type"?(v(),y(K,{key:1,color:"geekblue",bordered:!1},{default:l(()=>[m(de(p.db_type),1)]),_:2},1024)):h("",!0),o.dataIndex==="action"?(v(),ue(ie,{key:2},[t(x,{icon:"EditOutlined",label:"编辑",onClick:()=>{Object.assign(k,p),i.value=!0}},null,8,["onClick"]),t(S,{type:"vertical"}),t(x,{icon:"DeleteOutlined",label:"删除",onClick:T=>F(p)},null,8,["onClick"]),t(S,{type:"vertical"}),t(x,{icon:"SendOutlined",label:"测试连接性",onClick:T=>L(p)},null,8,["onClick"])],64)):h("",!0)]),_:1},8,["dataSource","columns","pagination","loading"])]),i.value?(v(),y(Z,{key:0,record:k,open:i.value,onOk:j,onCancel:a[3]||(a[3]=o=>i.value=!1)},null,8,["record","open"])):h("",!0)]),_:1})}}});const ze=ve(fe,[["__scopeId","data-v-063f0ffb"]]);export{ze as default};

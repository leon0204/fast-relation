var C=(z,h,r)=>new Promise((s,d)=>{var p=u=>{try{k(r.next(u))}catch(f){d(f)}},b=u=>{try{k(r.throw(u))}catch(f){d(f)}},k=u=>u.done?s(u.value):Promise.resolve(u.value).then(p,b);k((r=r.apply(z,h)).next())});import{_ as G}from"./CommonPage-69c64d74.js";import{u as Q,_ as X,N as Y}from"./CrudModal-4ad1e7dc.js";import{_ as U,C as Z,d as J,e as T}from"./CrudTable-77c6359e.js";import{m as _,cp as ee,O as v,a0 as x,R as l,Q as o,S as e,W as F,F as ie,ah as te,co as le,U as A,bU as ae,Y as g,H as ne,Z as P,P as S,y as q,V as $,bD as oe,$ as de,h as c,bV as ue,bW as ce,bX as V}from"./index-4af02034.js";import{N}from"./Input-a430a206.js";import{N as I}from"./Switch-2f74c195.js";import{N as me,a as m}from"./FormItem-f234d31c.js";import{N as re}from"./TreeSelect-99fbe1e1.js";import{N as se}from"./InputNumber-883f6641.js";import"./AppPage-24725091.js";import"./download-953ccaa2.js";import"./Tree-73292cf6.js";import"./Add-5786f0d6.js";const j=["mdi-air-humidifier-off","mdi-chili-off","mdi-cigar-off","mdi-clock-time-eight","mdi-clock-time-eight-outline","mdi-clock-time-eleven","mdi-clock-time-eleven-outline","mdi-clock-time-five","mdi-clock-time-five-outline","mdi-clock-time-four","mdi-clock-time-four-outline","mdi-clock-time-nine","mdi-clock-time-nine-outline","mdi-clock-time-one","mdi-clock-time-one-outline","mdi-clock-time-seven","mdi-clock-time-seven-outline","mdi-clock-time-six","mdi-clock-time-six-outline","mdi-clock-time-ten","mdi-clock-time-ten-outline","mdi-clock-time-three","mdi-clock-time-three-outline","mdi-clock-time-twelve","mdi-clock-time-twelve-outline","mdi-clock-time-two","mdi-clock-time-two-outline","mdi-cog-refresh","mdi-cog-refresh-outline","mdi-cog-sync","mdi-cog-sync-outline","mdi-content-save-cog","mdi-content-save-cog-outline","mdi-cosine-wave","mdi-cube-off","mdi-cube-off-outline","mdi-dome-light","mdi-download-box","mdi-download-box-outline","mdi-download-circle","mdi-download-circle-outline","mdi-fan-alert","mdi-fan-chevron-down","mdi-fan-chevron-up","mdi-fan-minus","mdi-fan-plus","mdi-fan-remove","mdi-fan-speed-1","mdi-fan-speed-2","mdi-fan-speed-3","mdi-food-drumstick","mdi-food-drumstick-off","mdi-food-drumstick-off-outline","mdi-food-drumstick-outline","mdi-food-steak","mdi-food-steak-off","mdi-fuse-alert","mdi-fuse-off","mdi-heart-minus","mdi-heart-minus-outline","mdi-heart-off-outline","mdi-heart-plus","mdi-heart-plus-outline","mdi-heart-remove","mdi-heart-remove-outline","mdi-hours-24","mdi-incognito-circle","mdi-incognito-circle-off","mdi-lingerie","mdi-microwave-off","mdi-minus-circle-off","mdi-minus-circle-off-outline","mdi-motion-sensor-off","mdi-pail-minus","mdi-pail-minus-outline","mdi-pail-off","mdi-pail-off-outline","mdi-pail-outline","mdi-pail-plus","mdi-pail-plus-outline","mdi-pail-remove","mdi-pail-remove-outline","mdi-pine-tree-fire","mdi-power-plug-off-outline","mdi-power-plug-outline","mdi-printer-eye","mdi-printer-search","mdi-puzzle-check","mdi-puzzle-check-outline","mdi-rug","mdi-sawtooth-wave","mdi-set-square","mdi-smoking-pipe-off","mdi-spoon-sugar","mdi-square-wave","mdi-table-split-cell","mdi-ticket-percent-outline","mdi-triangle-wave","mdi-waveform","mdi-wizard-hat","mdi-ab-testing","mdi-abjad-arabic","mdi-abjad-hebrew","mdi-abugida-devanagari","mdi-abugida-thai","mdi-access-point","mdi-access-point-network","mdi-access-point-network-off","mdi-account","mdi-account-alert","mdi-account-alert-outline","mdi-account-arrow-left","mdi-account-arrow-left-outline","mdi-account-arrow-right","mdi-account-arrow-right-outline","mdi-account-box","mdi-account-box-multiple","mdi-account-box-multiple-outline","mdi-account-box-outline","mdi-account-cancel","mdi-account-cancel-outline","mdi-account-cash","mdi-account-cash-outline","mdi-account-check","mdi-account-check-outline","mdi-account-child","mdi-account-child-circle","mdi-account-child-outline","mdi-account-circle","mdi-account-circle-outline","mdi-account-clock","mdi-account-clock-outline","mdi-account-cog","mdi-account-cog-outline","mdi-account-convert","mdi-account-convert-outline","mdi-account-cowboy-hat","mdi-account-details","mdi-account-details-outline","mdi-account-edit","mdi-account-edit-outline","mdi-account-group","mdi-account-group-outline","mdi-account-hard-hat","mdi-account-heart","mdi-account-heart-outline","mdi-account-key","mdi-account-key-outline","mdi-account-lock","mdi-account-lock-outline","mdi-account-minus","mdi-account-minus-outline","mdi-account-multiple","mdi-account-multiple-check","mdi-account-multiple-check-outline","mdi-account-multiple-minus","mdi-account-multiple-minus-outline","mdi-account-multiple-outline","mdi-account-multiple-plus","mdi-account-multiple-plus-outline","mdi-account-multiple-remove","mdi-account-multiple-remove-outline","mdi-account-music","mdi-account-music-outline","mdi-account-network","mdi-account-network-outline","mdi-account-off","mdi-account-off-outline","mdi-account-outline","mdi-account-plus","mdi-account-plus-outline","mdi-account-question","mdi-account-question-outline","mdi-account-remove","mdi-account-remove-outline","mdi-account-search","mdi-account-search-outline","mdi-account-settings","mdi-account-settings-outline","mdi-account-star","mdi-account-star-outline","mdi-account-supervisor","mdi-account-supervisor-circle","mdi-account-supervisor-outline","mdi-account-switch","mdi-account-switch-outline","mdi-account-tie","mdi-account-tie-outline","mdi-account-tie-voice","mdi-account-tie-voice-off","mdi-account-tie-voice-off-outline","mdi-account-tie-voice-outline","mdi-account-voice","mdi-adjust","mdi-adobe","mdi-adobe-acrobat","mdi-air-conditioner","mdi-air-filter","mdi-air-horn","mdi-air-humidifier","mdi-air-purifier","mdi-airbag","mdi-airballoon","mdi-airballoon-outline","mdi-airplane","mdi-airplane-landing","mdi-airplane-off","mdi-airplane-takeoff","mdi-airport","mdi-alarm","mdi-alarm-bell","mdi-alarm-check","mdi-alarm-light","mdi-alarm-light-outline","mdi-alarm-multiple","mdi-alarm-note","mdi-alarm-note-off","mdi-alarm-off","mdi-alarm-plus","mdi-alarm-snooze","mdi-album","mdi-alert","mdi-alert-box","mdi-alert-box-outline","mdi-alert-circle","mdi-alert-circle-check","mdi-alert-circle-check-outline","mdi-alert-circle-outline"],pe={class:"w-full"},fe=A("span",{class:"i-mdi:magnify text-18"},null,-1),ve=A("a",{class:"text-blue",target:"_blank",href:"https://icones.js.org/collection/all"}," Icones ",-1),he={key:0,class:"h-150 w-300 overflow-y-scroll"},ke=["onClick"],ge={key:1},be={__name:"IconPicker",props:{value:String},emits:["update:value"],setup(z,{emit:h}){const r=z,s=h,d=_(r.value),p=_(j);function b(){p.value=j.filter(u=>u.includes(d.value))}function k(u){d.value=u,s("update:value",d.value)}return ee(d,()=>{b(),s("update:value",d.value)},{debounce:200}),(u,f)=>(v(),x("div",pe,[l(e(le),{trigger:"click",placement:"bottom-start"},{trigger:o(()=>[l(e(N),{value:d.value,"onUpdate:value":[f[0]||(f[0]=y=>d.value=y),b],placeholder:"请输入图标名称"},{prefix:o(()=>[fe]),suffix:o(()=>[l(U,{icon:d.value,size:18},null,8,["icon"])]),_:1},8,["value"])]),footer:o(()=>[F(" 更多图标去 "),ve,F(" 查看 ")]),default:o(()=>[p.value.length?(v(),x("ul",he,[(v(!0),x(ie,null,te(p.value,(y,D)=>(v(),x("li",{key:D,class:"mx-5 inline-block cursor-pointer hover:text-cyan",onClick:a=>k(y)},[l(U,{icon:y,size:18},null,8,["icon"])],8,ke))),128))])):(v(),x("div",ge,[l(U,{icon:d.value,size:18},null,8,["icon"])]))]),_:1})]))}},Ve=Object.assign({name:"菜单管理"},{__name:"index",setup(z){const h=_(null),r=_({}),s=ae("permission"),d={order:1,keepalive:!0},{modalVisible:p,modalTitle:b,modalLoading:k,handleAdd:u,handleDelete:f,handleEdit:y,handleSave:D,modalForm:a,modalFormRef:O}=Q({name:"菜单",initForm:d,doCreate:g.createMenu,doDelete:g.deleteMenu,doUpdate:g.updateMenu,refresh:()=>{var i;return(i=h.value)==null?void 0:i.handleSearch()}});ne(()=>{var i;(i=h.value)==null||i.handleSearch(),R()});const M=_(!1),B=_([]),E=[{title:"ID",key:"id",width:50,ellipsis:{tooltip:!0},align:"center"},{title:"菜单名称",key:"name",width:80,ellipsis:{tooltip:!0},align:"center"},{title:"菜单类型",key:"menu_type",width:80,align:"center",ellipsis:{tooltip:!0},render(i){let t=!1,w=!1;return i.menu_type==="catalog"?(w=!0,t=!1):i.menu_type==="menu"&&(w=!1,t=!0),c(ue,{type:"primary",round:t,bordered:w},{default:()=>i.menu_type==="catalog"?"目录":"菜单"})}},{title:"图标",key:"icon",width:40,align:"center",render(i){return c(U,{icon:i.icon,size:20})}},{title:"排序",key:"order",width:40,ellipsis:{tooltip:!0},align:"center"},{title:"访问路径",key:"path",width:80,ellipsis:{tooltip:!0},align:"center"},{title:"跳转路径",key:"redirect",width:80,ellipsis:{tooltip:!0},align:"center"},{title:"组件路径",key:"component",width:80,ellipsis:{tooltip:!0},align:"center"},{title:"保活",key:"keepalive",width:40,align:"center",render(i){return c(I,{size:"small",rubberBand:!1,value:i.keepalive,onUpdateValue:()=>H(i)})}},{title:"隐藏",key:"is_hidden",width:40,align:"center",render(i){return c(I,{size:"small",rubberBand:!1,value:i.is_hidden,onUpdateValue:()=>K(i)})}},{title:"创建日期",key:"created_at",width:80,align:"center",render(i){return c("span",ce(i.created_at))}},{title:"操作",key:"actions",width:120,align:"center",fixed:"right",render(i){return[q(c($,{size:"tiny",quaternary:!0,type:"primary",style:`display: ${i.children&&i.menu_type!=="menu"?"":"none"};`,onClick:()=>{d.parent_id=i.id,d.menu_type="menu",M.value=!1,u()}},{default:()=>"子菜单",icon:V("material-symbols:add",{size:16})}),[[s,"post/api/v1/menu/create"]]),q(c($,{size:"tiny",quaternary:!0,type:"info",onClick:()=>{M.value=!1,y(i)}},{default:()=>"编辑",icon:V("material-symbols:edit-outline",{size:16})}),[[s,"post/api/v1/menu/update"]]),c(Y,{onPositiveClick:()=>f({id:i.id},!1)},{trigger:()=>q(c($,{size:"tiny",quaternary:!0,type:"error",style:`display: ${i.children&&i.children.length>0?"none":""};`},{default:()=>"删除",icon:V("material-symbols:delete-outline",{size:16})}),[[s,"delete/api/v1/menu/delete"]]),default:()=>c("div",{},"确定删除该菜单吗?")})]}}];function H(i){return C(this,null,function*(){i.id&&(i.publishing=!0,i.keepalive=i.keepalive===!1,yield g.updateMenu(i),i.publishing=!1,$message==null||$message.success(i.keepalive?"已开启":"已关闭"))})}function K(i){return C(this,null,function*(){i.id&&(i.publishing=!0,i.is_hidden=i.is_hidden===!1,yield g.updateMenu(i),i.publishing=!1,$message==null||$message.success(i.is_hidden?"已隐藏":"已取消隐藏"))})}function L(){d.parent_id=0,d.menu_type="catalog",d.is_hidden=!1,d.order=1,d.keepalive=!0,M.value=!0,u()}function R(){return C(this,null,function*(){const{data:i}=yield g.getMenus(),t={id:0,name:"根目录",children:[]};t.children=i,B.value=[t]})}return(i,t)=>{const w=P("a-col"),W=P("a-row");return v(),S(G,{"show-footer":"",title:"菜单列表"},{action:o(()=>[]),default:o(()=>[l(W,null,{default:o(()=>[l(w,{span:"24",style:{"text-align":"right"}},{default:o(()=>[q((v(),S(e($),{style:{"margin-bottom":"20px"},type:"primary",onClick:L},{default:o(()=>[l(U,{icon:"material-symbols:add",size:18,class:"mr-5"}),F(" 新建根菜单 ")]),_:1})),[[e(s),"post/api/v1/menu/create"]])]),_:1})]),_:1}),l(Z,{ref_key:"$table",ref:h,"query-items":r.value,"onUpdate:queryItems":t[0]||(t[0]=n=>r.value=n),"is-pagination":!1,columns:E,"get-data":e(g).getMenus,"single-line":!0},{add:o(()=>[]),_:1},8,["query-items","get-data"]),l(X,{visible:e(p),"onUpdate:visible":t[11]||(t[11]=n=>oe(p)?p.value=n:null),title:e(b),loading:e(k),onSave:t[12]||(t[12]=n=>e(D)(R))},{default:o(()=>[l(e(me),{ref_key:"modalFormRef",ref:O,"label-placement":"left","label-align":"left","label-width":80,model:e(a)},{default:o(()=>[l(e(m),{label:"菜单类型",path:"menu_type"},{default:o(()=>[l(e(J),{value:e(a).menu_type,"onUpdate:value":t[1]||(t[1]=n=>e(a).menu_type=n)},{default:o(()=>[l(e(T),{label:"目录",value:"catalog"}),l(e(T),{label:"菜单",value:"menu"})]),_:1},8,["value"])]),_:1}),l(e(m),{label:"上级菜单",path:"parent_id"},{default:o(()=>[l(e(re),{value:e(a).parent_id,"onUpdate:value":t[2]||(t[2]=n=>e(a).parent_id=n),"key-field":"id","label-field":"name",options:B.value,"default-expand-all":"true"},null,8,["value","options"])]),_:1}),l(e(m),{label:"菜单名称",path:"name",rule:{required:!0,message:"请输入唯一菜单名称",trigger:["input","blur"]}},{default:o(()=>[l(e(N),{value:e(a).name,"onUpdate:value":t[3]||(t[3]=n=>e(a).name=n),placeholder:"请输入唯一菜单名称"},null,8,["value"])]),_:1}),l(e(m),{label:"访问路径",path:"path",rule:{required:!0,message:"请输入访问路径",trigger:["blur"]}},{default:o(()=>[l(e(N),{value:e(a).path,"onUpdate:value":t[4]||(t[4]=n=>e(a).path=n),placeholder:"请输入访问路径"},null,8,["value"])]),_:1}),e(a).menu_type==="menu"?(v(),S(e(m),{key:0,label:"组件路径",path:"component"},{default:o(()=>[l(e(N),{value:e(a).component,"onUpdate:value":t[5]||(t[5]=n=>e(a).component=n),placeholder:"请输入组件路径，例如：/system/user"},null,8,["value"])]),_:1})):de("",!0),l(e(m),{label:"跳转路径",path:"redirect"},{default:o(()=>[l(e(N),{value:e(a).redirect,"onUpdate:value":t[6]||(t[6]=n=>e(a).redirect=n),disabled:e(a).parent_id!==0,placeholder:e(a).parent_id!==0?"只有一级菜单可以设置跳转路径":"请输入跳转路径"},null,8,["value","disabled","placeholder"])]),_:1}),l(e(m),{label:"菜单图标",path:"icon"},{default:o(()=>[l(be,{value:e(a).icon,"onUpdate:value":t[7]||(t[7]=n=>e(a).icon=n)},null,8,["value"])]),_:1}),l(e(m),{label:"显示排序",path:"order"},{default:o(()=>[l(e(se),{value:e(a).order,"onUpdate:value":t[8]||(t[8]=n=>e(a).order=n),min:1},null,8,["value"])]),_:1}),l(e(m),{label:"是否隐藏",path:"is_hidden"},{default:o(()=>[l(e(I),{value:e(a).is_hidden,"onUpdate:value":t[9]||(t[9]=n=>e(a).is_hidden=n)},null,8,["value"])]),_:1}),l(e(m),{label:"KeepAlive",path:"keepalive"},{default:o(()=>[l(e(I),{value:e(a).keepalive,"onUpdate:value":t[10]||(t[10]=n=>e(a).keepalive=n)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title","loading"])]),_:1})}}});export{Ve as default};

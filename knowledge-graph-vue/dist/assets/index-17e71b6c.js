var U=(R,F,d)=>new Promise((k,b)=>{var z=l=>{try{y(d.next(l))}catch(w){b(w)}},V=l=>{try{y(d.throw(l))}catch(w){b(w)}},y=l=>l.done?k(l.value):Promise.resolve(l.value).then(z,V);y((d=d.apply(R,F)).next())});import{_ as ne}from"./index.vue_vue_type_script_setup_true_lang-24ddc9a9.js";import{_ as oe}from"./dataSourceModel.vue_vue_type_script_setup_true_lang-e2007d9d.js";import{_ as se}from"./CommonPage-69c64d74.js";import{d as le,m as s,aq as q,ak as ie,H as de,aa as re,Z as p,O as u,P as B,Q as o,R as n,S as D,at as E,W as i,U as K,a0 as C,F as I,X as v,$ as _,aj as $,ai as N,as as P,_ as ue}from"./index-4af02034.js";import"./AppPage-24725091.js";const ce={class:"content-table"},pe={class:"dialog-footer"},_e=le({__name:"index",setup(R){s();const F=q({}),d=s(!1),k=s([]);s([]);const b=s({}),z=s([]),V=s(0),y=s(!1),l=s(!1),w=s([]),f=s([]),T=s(null),Q=s(""),c=q({current:1,page_size:10,pageSizeOptions:["10","20","30","40"],page:1,total:0,showSizeChanger:!0,showQuickJumper:!1,showTotal:t=>`总记录 ${t} `,onChange(t,e){c.page_size=e,c.current=t,c.page=t,S()}}),W=s([{title:"姓名",dataIndex:"name",key:"name"},{title:"年龄",dataIndex:"age",key:"age"},{title:"出生年",dataIndex:"birth_year",key:"birth_year"},{title:"职业",dataIndex:"occupation",key:"occupation"},{title:"地址",dataIndex:"address",key:"address"},{title:"爱好",dataIndex:"hobby",key:"hobby"},{title:"身份",dataIndex:"identity",key:"identity"},{title:"角色",dataIndex:"role",key:"role"},{title:"来源",dataIndex:"source",key:"source"}]);function S(){if(d.value)return;d.value=!0;const t={};t.name=b.value.name?b.value.name:null,t.page=c.page,t.pagesize=c.page_size,t.index="entity",ie("/kg/entity/list",t).then(e=>{var g,r,h,x;z.value=e.data.data,c.total=((r=(g=e==null?void 0:e.data)==null?void 0:g.pagination)==null?void 0:r.total)||0,V.value=((x=(h=e==null?void 0:e.data)==null?void 0:h.pagination)==null?void 0:x.total)||0,d.value=!1})}function j(){y.value=!1,S()}de(()=>{const e=re().query.id;Q.value=e,S()});function G(){c.page=1,c.current=1,S()}const H={onChange:(t,e)=>{console.log(`selectedRowKeys: ${t}`,"selectedRows: ",e),k.value=t},getCheckboxProps:t=>({disabled:t.name==="Disabled User",name:t.name})},J=t=>U(this,null,function*(){const e=[];if(console.log(f.value),f.value&&f.value.length==0)return $("请选择实体"),!1;w.value.map(r=>{f.value.map(h=>{r._id==h&&e.push(r._id)})}),e.push(T.value._id);const g={};g.entity_id=T.value._id,g.entity_list=e,N("/knowledge_merge/disambiguation",g).then(r=>{r.code==200?(P("实体消歧成功"),O(),l.value=!1):$("实体消歧失败")})}),M=()=>{N("/kg/fusion/entity",{}).then(t=>{t.code==200?(P("实体属性融合成功"),O()):$("实体属性融合失败")})},X=t=>{},O=()=>{S()},Z=()=>{if(console.log(f.value),k.value&&k.value.length==0)return $("请勾选实体"),!1;const t={};t.entity_id=k.value[0],t.entity_list=k.value,N("/kg/disambiguation",t).then(e=>{e.code==200?(P("实体消歧成功"),O()):$("实体消歧失败")})};return(t,e)=>{const g=p("a-input-search"),r=p("a-space"),h=p("a-col"),x=p("a-button"),A=p("a-row"),L=p("a-tag"),Y=p("a-table"),ee=ne,te=p("a-transfer"),ae=p("a-modal");return u(),B(se,{"show-footer":"",title:"数据源管理"},{default:o(()=>[n(A,null,{default:o(()=>[n(h,{span:"16"},{default:o(()=>[n(r,null,{default:o(()=>[n(g,{value:b.value.name,"onUpdate:value":e[0]||(e[0]=a=>b.value.name=a),placeholder:"请输入关键字","enter-button":"查询",style:{width:"500px"},onSearch:G,loading:d.value},null,8,["value","loading"])]),_:1})]),_:1}),n(h,{span:8,style:{"text-align":"right"}},{default:o(()=>[n(r,null,{default:o(()=>[n(x,{type:"primary",style:{"background-color":"#F56C6C"},onClick:M},{default:o(()=>[n(D(E)),i(" 属性融合 ")]),_:1}),n(x,{type:"primary",style:{"background-color":"#F56C6C"},onClick:Z},{default:o(()=>[n(D(E)),i(" 实体消歧 ")]),_:1})]),_:1})]),_:1})]),_:1}),K("div",ce,[n(Y,{size:"middle",dataSource:z.value,columns:W.value,pagination:c,rowKey:"_id","row-selection":H,loading:d.value},{bodyCell:o(({column:a,record:m})=>[a.dataIndex==="age"?(u(),C(I,{key:0},[i(v(m.properties.age),1)],64)):_("",!0),a.dataIndex==="birth_year"?(u(),C(I,{key:1},[i(v(m.properties.birth_year),1)],64)):_("",!0),a.dataIndex==="occupation"?(u(),C(I,{key:2},[i(v(m.properties.occupation),1)],64)):_("",!0),a.dataIndex==="address"?(u(),C(I,{key:3},[i(v(m.properties.address),1)],64)):_("",!0),a.dataIndex==="hobby"?(u(),C(I,{key:4},[i(v(m.properties.hobby),1)],64)):_("",!0),a.dataIndex==="identity"?(u(),C(I,{key:5},[i(v(m.properties.identity),1)],64)):_("",!0),a.dataIndex==="role"?(u(),C(I,{key:6},[i(v(m.properties.role),1)],64)):_("",!0),a.dataIndex==="source"?(u(),B(L,{key:7,color:"geekblue",bordered:!1},{default:o(()=>[i(v(m.properties.source),1)]),_:2},1024)):_("",!0)]),_:1},8,["dataSource","columns","pagination","loading"])]),y.value?(u(),B(oe,{key:0,record:F,open:y.value,onOk:j,onCancel:e[1]||(e[1]=a=>y.value=!1)},null,8,["record","open"])):_("",!0),n(ae,{open:l.value,"close-on-click-modal":!1,width:"500px",onCancel:e[5]||(e[5]=a=>l.value=!1)},{title:o(()=>[n(ee,{title:"实体消歧"})]),footer:o(()=>[K("div",pe,[n(x,{onClick:e[3]||(e[3]=a=>l.value=!1)},{default:o(()=>[i("取消")]),_:1}),n(x,{type:"primary",onClick:e[4]||(e[4]=a=>J(f.value))},{default:o(()=>[i("保存")]),_:1})])]),default:o(()=>[n(te,{style:{width:"100%"},"target-keys":f.value,"onUpdate:targetKeys":e[2]||(e[2]=a=>f.value=a),filterable:"","data-source":w.value,onChange:X,render:a=>a.name},null,8,["target-keys","data-source","render"])]),_:1},8,["open"])]),_:1})}}});const be=ue(_e,[["__scopeId","data-v-6e639d7d"]]);export{be as default};

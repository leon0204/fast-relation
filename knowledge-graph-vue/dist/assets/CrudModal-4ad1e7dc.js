var H=Object.defineProperty;var T=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var S=(e,t,o)=>t in e?H(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,P=(e,t)=>{for(var o in t||(t={}))J.call(t,o)&&S(e,o,t[o]);if(T)for(var o of T(t))Q.call(t,o)&&S(e,o,t[o]);return e};var w=(e,t,o)=>new Promise((a,c)=>{var r=i=>{try{n(o.next(i))}catch(s){c(s)}},l=i=>{try{n(o.throw(i))}catch(s){c(s)}},n=i=>i.done?a(i.value):Promise.resolve(i.value).then(r,l);n((o=o.apply(e,t)).next())});import{c as G,d as F,s as U,p as X,q as C,v as Y,l as _,cl as N,h as v,V as k,cv as Z,N as ee,a6 as te,di as oe,f as B,a3 as b,e as z,u as E,dj as ne,m as g,J as ie,dk as se,cT as ae,co as le,dl as re,cg as O,db as ce,O as ue,P as de,dm as ve,Q as y,U as pe,bK as j,R,W as $,S as fe,bD as me,C as ge,dn as he}from"./index-4af02034.js";import{u as I}from"./Input-a430a206.js";const q=G("n-popconfirm"),D={positiveText:String,negativeText:String,showIcon:{type:Boolean,default:!0},onPositiveClick:{type:Function,required:!0},onNegativeClick:{type:Function,required:!0}},V=oe(D),Pe=F({name:"NPopconfirmPanel",props:D,setup(e){const{localeRef:t}=I("Popconfirm"),{inlineThemeDisabled:o}=U(),{mergedClsPrefixRef:a,mergedThemeRef:c,props:r}=X(q),l=C(()=>{const{common:{cubicBezierEaseInOut:i},self:{fontSize:s,iconSize:d,iconColor:u}}=c.value;return{"--n-bezier":i,"--n-font-size":s,"--n-icon-size":d,"--n-icon-color":u}}),n=o?Y("popconfirm-panel",void 0,l,r):void 0;return Object.assign(Object.assign({},I("Popconfirm")),{mergedClsPrefix:a,cssVars:o?void 0:l,localizedPositiveText:C(()=>e.positiveText||t.value.positiveText),localizedNegativeText:C(()=>e.negativeText||t.value.negativeText),positiveButtonProps:_(r,"positiveButtonProps"),negativeButtonProps:_(r,"negativeButtonProps"),handlePositiveClick(i){e.onPositiveClick(i)},handleNegativeClick(i){e.onNegativeClick(i)},themeClass:n==null?void 0:n.themeClass,onRender:n==null?void 0:n.onRender})},render(){var e;const{mergedClsPrefix:t,showIcon:o,$slots:a}=this,c=N(a.action,()=>this.negativeText===null&&this.positiveText===null?[]:[this.negativeText!==null&&v(k,Object.assign({size:"small",onClick:this.handleNegativeClick},this.negativeButtonProps),{default:()=>this.localizedNegativeText}),this.positiveText!==null&&v(k,Object.assign({size:"small",type:"primary",onClick:this.handlePositiveClick},this.positiveButtonProps),{default:()=>this.localizedPositiveText})]);return(e=this.onRender)===null||e===void 0||e.call(this),v("div",{class:[`${t}-popconfirm__panel`,this.themeClass],style:this.cssVars},Z(a.default,r=>o||r?v("div",{class:`${t}-popconfirm__body`},o?v("div",{class:`${t}-popconfirm__icon`},N(a.icon,()=>[v(ee,{clsPrefix:t},{default:()=>v(te,null)})])):null,r):null),c?v("div",{class:[`${t}-popconfirm__action`]},c):null)}}),Ce=B("popconfirm",[b("body",`
 font-size: var(--n-font-size);
 display: flex;
 align-items: center;
 flex-wrap: nowrap;
 position: relative;
 `,[b("icon",`
 display: flex;
 font-size: var(--n-icon-size);
 color: var(--n-icon-color);
 transition: color .3s var(--n-bezier);
 margin: 0 8px 0 0;
 `)]),b("action",`
 display: flex;
 justify-content: flex-end;
 `,[z("&:not(:first-child)","margin-top: 8px"),B("button",[z("&:not(:last-child)","margin-right: 8px;")])])]),ye=Object.assign(Object.assign(Object.assign({},E.props),re),{positiveText:String,negativeText:String,showIcon:{type:Boolean,default:!0},trigger:{type:String,default:"click"},positiveButtonProps:Object,negativeButtonProps:Object,onPositiveClick:Function,onNegativeClick:Function}),_e=F({name:"Popconfirm",props:ye,__popover__:!0,setup(e){const{mergedClsPrefixRef:t}=U(),o=E("Popconfirm","-popconfirm",Ce,ne,e,t),a=g(null);function c(n){var i;if(!(!((i=a.value)===null||i===void 0)&&i.getMergedShow()))return;const{onPositiveClick:s,"onUpdate:show":d}=e;Promise.resolve(s?s(n):!0).then(u=>{var p;u!==!1&&((p=a.value)===null||p===void 0||p.setShow(!1),d&&O(d,!1))})}function r(n){var i;if(!(!((i=a.value)===null||i===void 0)&&i.getMergedShow()))return;const{onNegativeClick:s,"onUpdate:show":d}=e;Promise.resolve(s?s(n):!0).then(u=>{var p;u!==!1&&((p=a.value)===null||p===void 0||p.setShow(!1),d&&O(d,!1))})}return ie(q,{mergedThemeRef:o,mergedClsPrefixRef:t,props:e}),{setShow(n){var i;(i=a.value)===null||i===void 0||i.setShow(n)},syncPosition(){var n;(n=a.value)===null||n===void 0||n.syncPosition()},mergedTheme:o,popoverInstRef:a,handlePositiveClick:c,handleNegativeClick:r}},render(){const{$slots:e,$props:t,mergedTheme:o}=this;return v(le,ae(t,V,{theme:o.peers.Popover,themeOverrides:o.peerOverrides.Popover,internalExtraClass:["popconfirm"],ref:"popoverInstRef"}),{trigger:e.activator||e.trigger,default:()=>{const a=se(t,V);return v(Pe,Object.assign(Object.assign({},a),{onPositiveClick:this.handlePositiveClick,onNegativeClick:this.handleNegativeClick}),e)}})}}),xe={view:"查看",edit:"编辑",add:"新增"};function Ne({name:e,initForm:t={},doCreate:o,doDelete:a,doUpdate:c,refresh:r}){const l=g(!1),n=g(""),i=C(()=>xe[n.value]+e),s=g(!1),d=g(null),u=g(P({},t));function p(){n.value="add",l.value=!0,u.value=P({},t)}function K(f){n.value="edit",l.value=!0,u.value=P({},f)}function W(f){n.value="view",l.value=!0,u.value=P({},f)}function A(...f){var h;if(!["edit","add"].includes(n.value)){l.value=!1;return}(h=d.value)==null||h.validate(M=>w(this,null,function*(){if(M)return;const x={add:{api:()=>o(u.value),cb:()=>{f.forEach(m=>m&&m())},msg:()=>$message.success("新增成功")},edit:{api:()=>c(u.value),cb:()=>{f.forEach(m=>m&&m())},msg:()=>$message.success("编辑成功")}}[n.value];try{s.value=!0;const m=yield x.api();x.cb(),x.msg(),s.value=l.value=!1,m&&r(m)}catch(m){s.value=!1}}))}function L(){return w(this,arguments,function*(f={}){if(!ce(f))try{s.value=!0;const h=yield a(f);$message.success("删除成功"),s.value=!1,r(h)}catch(h){s.value=!1}})}return{modalVisible:l,modalAction:n,modalTitle:i,modalLoading:s,handleAdd:p,handleDelete:L,handleEdit:K,handleView:W,handleSave:A,modalForm:u,modalFormRef:d}}const we={flex:"","justify-end":""},Be={__name:"CrudModal",props:{width:{type:String,default:"600px"},title:{type:String,default:""},showFooter:{type:Boolean,default:!0},visible:{type:Boolean,required:!0},loading:{type:Boolean,default:!1}},emits:["update:visible","onSave"],setup(e,{emit:t}){const o=e,a=t,c=C({get(){return o.visible},set(r){a("update:visible",r)}});return(r,l)=>{const n=k,i=he;return ue(),de(i,{show:fe(c),"onUpdate:show":l[2]||(l[2]=s=>me(c)?c.value=s:null),style:ge({width:e.width}),preset:"card",title:e.title,size:"huge",bordered:!1,"mask-closable":!1},ve({default:y(()=>[j(r.$slots,"default")]),_:2},[e.showFooter?{name:"footer",fn:y(()=>[pe("footer",we,[j(r.$slots,"footer",{},()=>[R(n,{onClick:l[0]||(l[0]=s=>c.value=!1)},{default:y(()=>[$("取消")]),_:1}),R(n,{loading:e.loading,"ml-20":"",type:"primary",onClick:l[1]||(l[1]=s=>a("save"))},{default:y(()=>[$("保存")]),_:1},8,["loading"])])])]),key:"0"}:void 0]),1032,["show","style","title"])}}};export{_e as N,Be as _,Ne as u};
